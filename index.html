<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>ONE TAP SURVIVE</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">

  <style>
    body {
      margin: 0;
      background: #0f0f0f;
      overflow: hidden;
      font-family: system-ui, sans-serif;
      touch-action: manipulation;
    }

    #score {
      position: fixed;
      top: 12px;
      left: 50%;
      transform: translateX(-50%);
      color: #fff;
      font-size: 20px;
      opacity: 0.8;
    }

    #gameover {
      position: fixed;
      inset: 0;
      display: none;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      background: rgba(0,0,0,0.8);
      color: #fff;
    }

    button {
      padding: 12px 24px;
      font-size: 16px;
      border: none;
      border-radius: 8px;
      margin-top: 16px;
      cursor: pointer;
    }
  </style>
</head>
<body>

<div id="score">0</div>

<div id="gameover">
  <h1>GAME OVER</h1>
  <p id="finalScore"></p>
  <button onclick="restart()">Restart</button>
</div>

<canvas id="game"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

canvas.width = innerWidth;
canvas.height = innerHeight;

let player = {
  x: canvas.width / 2,
  y: canvas.height - 100,
  r: 16,
  dir: 1
};

let obstacles = [];
let speed = 3;
let score = 0;
let alive = true;

function spawnObstacle() {
  obstacles.push({
    x: Math.random() * canvas.width,
    y: -20,
    r: 12
  });
}

setInterval(spawnObstacle, 700);

function tap() {
  if (!alive) return;
  player.dir *= -1;
}

addEventListener("pointerdown", tap);

function update() {
  if (!alive) return;

  ctx.clearRect(0,0,canvas.width,canvas.height);

  // player move
  player.x += player.dir * 4;
  if (player.x < player.r || player.x > canvas.width - player.r) {
    player.dir *= -1;
  }

  // draw player
  ctx.beginPath();
  ctx.arc(player.x, player.y, player.r, 0, Math.PI*2);
  ctx.fillStyle = "#00ffcc";
  ctx.fill();

  // obstacles
  for (let o of obstacles) {
    o.y += speed;

    ctx.beginPath();
    ctx.arc(o.x, o.y, o.r, 0, Math.PI*2);
    ctx.fillStyle = "#ff4d4d";
    ctx.fill();

    // collision
    let dx = o.x - player.x;
    let dy = o.y - player.y;
    let dist = Math.sqrt(dx*dx + dy*dy);
    if (dist < o.r + player.r) {
      endGame();
    }
  }

  obstacles = obstacles.filter(o => o.y < canvas.height + 50);

  score++;
  speed += 0.0005;
  document.getElementById("score").textContent = score;

  requestAnimationFrame(update);
}

function endGame() {
  alive = false;
  document.getElementById("finalScore").textContent = "Score: " + score;
  document.getElementById("gameover").style.display = "flex";
}

function restart() {
  obstacles = [];
  speed = 3;
  score = 0;
  alive = true;
  document.getElementById("gameover").style.display = "none";
  update();
}

update();
</script>

</body>
</html>
